import { decrypt } from "../../src/lib/decrypt"
import chai from "chai";
import chaiAsPromised from 'chai-as-promised';

chai.use(chaiAsPromised);

const { expect } = chai;

const data = {
  passphrase: '123456789abcdef',
  encryptedMessage: 'LS0tLS1CRUdJTiBQR1AgTUVTU0FHRS0tLS0tCgp3Y0JNQTVZK21UazY2NnZEQVFmL1k1UVBuSDgwT2hJNmljMlcvdXhWVWpJZXdiSUFYZTBXaTZyRHIydlQKWGtGckhZTUEyZ2k2cmJSZ3prNlFqREl3MVdSajhFcUVqZ3k0V2lLQTFFQkorYnRVNmZ5WUQvdDVreDVtClZCL0pEUndNN1lHbm50MmwvWXBCUzNxU2puRi8vdk5wQ0RsYWtXVGVWd1dOcUZVTXN1NkxhemdHOHJzUQovNGZDU05BbzNlc1RMb1ZsaFNUZHVUUUhPWW9yYTJRTlFXMGMrUzBWSTFHNHRXZnUzWEcyVXBqTzhsYkQKZWIvRTN1ajkxbU9ndm5ERGZvNmsrQ083UmgvaE1ESmJmK2pqUkJRNDJtRDdwQUVzMnZnbWZzRlNsT3VSClMzUGQ5TFEwaFNBRWJNais1WUNOSUFXbW1sTVBKeUJwWTNMbVpJWXdMWktzQ2ZvR3FxcFlzcS9oamZ2MwpsdExBMEFFMDBWNHpKaTdkV2ZIMWRjOEZGN1dLcGM3eTRZVEVkS090ekJ1ZldYMFJISnNWelIrckdsenQKU1FKZWNZYlUrd0FWbFFkSVF2MTJFQ3BDWGZ5R1pxMXF3aFYzWURQQnM3K3MwRnlkQ3pzMWJnZkpBWGNEClkxNnE4WUszcktCd0pQWDU1bE45T1o2SUc1NVU4Tmk1eXpGeFk2Vnppa1lIUWkvNEtFa1VnZTBaRi93OQpLL3ZIaTl5N2V3SXZjeE8rQmlDVnVLK2pDcE1LMG4vTisyTDBoRTcwSW1JbDhoUHZKR3NxaUtDejdSbmcKTURZN09nS2ZzY1dvakIvVkdYOVVkdlVoUkI0czJvVC9JMGRDbUpNUEk0MVVtenZ1OUMzNXVUUU1XS0F0Ck1HcERTQnZpWmp1eUdGQXhyUnVxa3ZHYXBpZWpRU1pWVVd1ZjJNMXlaWnlzYlA4SC9GNTFkekxlYjR5YQphU2psdHdXYlpZdFQrYUVrSGFDNDMxT1NGM0tleXpVRzYwUU14a09oNDIzaFc2SW9Ca2hKRlZ1SHI2WHAKUGtubS9lZnFUQzF1ZU9vZFAraUV1ejdHalJpeGhTSWEwSUtxeHl2VlpDc2JsUGM4RnFtbVdPRjl3emJVCjBtbndER1FxL2pQaHlvNmJ5aFBvZnVjMWYzdUFOWm8rbkxQLzdkZDEzSFRHb3RtRHZWbzhTaDJ5MEdZPQo9dEpLcQotLS0tLUVORCBQR1AgTUVTU0FHRS0tLS0tCg==',
  publicKey: 'LS0tLS1CRUdJTiBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0tCgp4c0JOQkdLc2dFZ0JDQUM3ODBFR1hiamVzZ0E0YkFPMTNqYVN2REdqUUIrTHB1RGlWdGlDL0ZmejRIdjMKOWUxejV2dWNtckFwQjZJS3NtQytMazZuVmgxWUhaeXFTUk10N0NQU3Vham1SRVZNZTgzU3RsR0RuT1NnCkx1dkxJemduc0pTamlqcUJVQUNrbGZ5emhoNzJ0b3BIWXVjRUZFVDVDSG9FWEJaOGhYZkNpNjNITk9ILwpadWVYM3h5eHY3QUp1WFZqd0RoMlcyWUkyendTd01NK1Z3ZEhFNUs3TVo4eG0zSk9IVGpHRVYyS3dHa28KYTl6dHZ6TWVyNkpxWjQ5bmpqOGpoVHhidVlONFJBQkUrcWc1a1RJejFpbStkRXNncWhDelpyeGJOMEZtCjdFNWZ1YUorbGtGVmpYM3J6U3VWMzdTb0hNMThJZzJwRHdCN2JrelF1TjlWaXorUGNtZFFaM3JqQUJFQgpBQUhORjBwaGJtVWdSRzlsSUR4cVlXNWxRR1J2WlM1amIyMCt3c0NLQkJBQkNBQWRCUUppcklCSUJBc0oKQndnREZRZ0tCQllBQWdFQ0dRRUNHd01DSGdFQUlRa1EySlNGTTI0T1liOFdJUVJkaHNtRkhzSTdYeFdmCmZOYllsSVV6Ymc1aHY0ZWhDQUN2Vm0xcmdHWW9Pc1hES1NjTVVMOGFvRU1IRE5lUURGNVUzeWJreUJCMQpXM0RTUVhUaUtkTXBMM01qVTFMam05bDlCUFpWMDJnSElCWlVyNXNtUmpTeDBIZGJNNzZRcElSMGZQK3gKTXJDN0o5THZVcExMNVZ5bkFsWnArbjBKeWQxN216RUtUNkQ4Uk45NkVrYlFQMEhmb3F5b2V3QVpaZVdHCmJXcXZsalFteWZGdUgrb1ZUOHlLOThJZkV2NWppK2dQbFVTVDBOb2RML2hFRnY2UFdRWGo2VkZrNmV0YQozekxzV3U5aWZwREhkdHBXMFBXUEwwSmhTQ3E0NDN1ZllJVmg3em1QeW42MW16UnpyQTZsdS9VN1JKMWkKZE1NSUpsZUxic0dScEVNYWRXdkM2a3JjeG5uUmsvMEduQXFVS3N5d3BrZnJIYXljNitKRW1PcmswOWdhCnpzQk5CR0tzZ0VnQkNBQ3FwWDduemQ3cjVxdmZjMzRjL1h6dmVudGZEN215aGl4YTJqa1hzVlpOSWZuegpRRm1YR1lCVGdsazhZclFJblRhSzcyaTdleXVGSlBIVzBjV3dwTTFmRWpPYmYwb0swZG1jSGZtWm5aUWEKYWpibHg1Z0pUb1BVRURmYzBUUEdoUWNma1Q2eW9vYTUrRjdlYnNMVGk3SWJDeFFPNTFjdGRBRVArNjlDCkpyOFovdWY1am94MmgzOTZvU3pFd1FjOFF0UkdGVkR1ZHpJUEw4VCs2SVpvV1NLbWVUTTcvcXVmNHNydwpjY0FWb1V1YllQNHVuQ3IzQTVZYnB3cW83L25lWkd2UVFZcDhneXdqclcrclovNVlCc1BCUnZwQVduTGoKNy9pMlJRRFlSWEJJWG9kRmc2eXBXQU8vWVd1UTczcWd2UzZSTDBiT0VuMGpiU2RYbGJReWZsakpBQkVCCkFBSEN3SFlFR0FFSUFBa0ZBbUtzZ0VnQ0d3d0FJUWtRMkpTRk0yNE9ZYjhXSVFSZGhzbUZIc0k3WHhXZgpmTmJZbElVemJnNWh2NXliQi85aFRFNytHMktoRnh2ZUpMRG1RbUt6Z1BxUDdJRCtUbThHSi82WTZXM0YKeEsxT3M0TFBrNmFEUklSUXNhNU5FZjUrNGZkZVpXSE9mcWRwazFacW9VMU8wTG1rMThKNG1OTkUwOW02CkxWb3kwS09Qb2c5OTZQRThQVWZHM2RaYTRnMXJVNlZnT1dlZGc2UElxT3JDeFBiQmtGU2dzYmhmdzJ1MQpVNWp5UkRUeXQzVGw3YjZOQVR4OEFQSW5EZDNGVk45WDRDMkFFMGJmQWoyYU82L29JalJYOHFLeG0vMisKMDdFNDJoQWorNFBSZHJLZjJYS2tXUFZ3bk5iREdxMDJ1a0M5eWV0aHRYR3N4QXM3VjFOWmdKZWZLUXZKCnNsbXFJMWcyanp1dkFwVU1YQ1JuOWMwd3BQcEZ6a1k2SkxKZWtSNmVDZnQxK2xqeWxtMjZ1UTltTjBGTAo9UnQ3MAotLS0tLUVORCBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0tCg==',
};


describe('decrypt', function () {
  it('should decrypt a message', async function () {
    const test = decrypt(data);
    await expect(test).to.eventually.be.fulfilled;
  });
});

