import { decrypt } from "../../src/bin/cryptolib"
import chai from "chai";
import chaiAsPromised from 'chai-as-promised';

chai.use(chaiAsPromised);
const { expect } = chai;

const data = {
  passphrase: '123456789abcdef',
  encryptedMessage: 'LS0tLS1CRUdJTiBQR1AgTUVTU0FHRS0tLS0tCgp3Y0JNQTVZK21UazY2NnZEQVFmL2E4WmxzVWNOeWZNc3ZyMUx1LzhCV0ZyU2pxS3V3aWFJT1V6Q2QvUnkKQzNQb2o2OU1UMXF2eSt3alRYbzMwTnN5Zy9oU29iOWFndlFWVDQ4VkVHNDVmc09hMDFZZTVBZHVmOFJDCnFaOENZeE1lNnZHOUtJUWRhcUdRQXhlVkQ4RmdQemQxWGVJQVhNRWdNanhKV3owelpuVlNjVWRxeFFzdAp2aE5KREptT3lUaFQyV1V4QkVqanJWMGFaL3p5M3VuUkdLd2JESVdmYXEwNjBudXdxNmNHc1BJemtaRUUKdXVFSmNOcDlseXVtcllyYVZISlF6aVFwMHp6aFNoS0hIQ1RreGdWWUFFYnIycmlneUJqR0FuMExCMHp4CjY3TlNRUFZTWi90SVluUis4cUtLbnpVcTNMV054MHRiMHBreEdDNHhNSlVmNmsvc2svSU5NS2Y4cmZNSApHOUxBMEFIWU9zeTZQWUNhMytpTm4rUHBLa1pidkpTTnpVS0h1d0s2UTk5NFdHbkI5TTNzMy9aNU5hcVcKSnJ3SHFOSXlRL1AvSkpqa2ovckNlczR1ekNxUWxtU3lOM1BLRVRodm9PY1Z4Q2hIVnBnRWFxOEdhaURuCmlTZXI1YmRPMmpNRlNQRlR5VVpKV1NPcmw3Sk9kMU0wUTV5K2NXRTYxRy9wSXVwTVhDSTJpamxzZklPWQpQS2RQYmNSV3BUQjI0RmU3MGlpQTRRQzA0c1BCVk95a3h4ckh4N3lPMDh3WExCaE8xUGxSRFVJN3F2YWMKYjhRTVEweVRDenhPZktHU2MzK0RaWVpFRzB4dkZ2dDNUdERHWnV1a2NFNzhUZ1pOV2NTeVVhS1ByanZaCmRWdEUvWTZiM25PODEwbENMQ1M3TXJkNUNXbytEc0xYVU5zOFZQSXpQZzNrc2hqaDhiZmlnZkJvSmpmOApGK3lnT3kzaWVMY3B1SFJadncxMHpmd1RYVFprVVliL0ZaK3FGOXJQcHFFVEEzWUMrVzVlOGlvS1N6VEMKQ0ZtZzNKOGFzSmEwZmMrRktNQzB3OHdMVTczMzJZK3I0WFlWKzZ3UHpxTll3TFR6a2Q4eXN2TWsvcllLCkl0VCtqZjFwZm5DVTMwWDNQNkIvbE1qOFNRcVFsa1hsV3FWMUhJYTRCMDBZU0xEVkorUmorUFJid2RvPQo9d29nUQotLS0tLUVORCBQR1AgTUVTU0FHRS0tLS0tCg==',
  publicKey: 'LS0tLS1CRUdJTiBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0tCgp4c0JOQkdMRjgra0JDQUQySG4vOXJ1SGlYaS8yRG1wSlhUY1FHRG5nM29WOWFXaFlRYlhxL3crZ3F3RkoKRXJPS1JrMDJLMnB5UWUwQnlFbk5KVG9lOHBQempTVDFldjZkc2ZTSHl2MmVleEs0TklibElXTklyZnIxCnp1SEFrd0ljRGJ0SXMzWkN3dnliTVhtYmtheG1SdGxHSEwrdmxaN2tSOVNnU2M0NGY3LzA4VWtFNkxWKwpMazdFUXY2c0hOS0FnaWllWGRLSWVxVGJWa1hoVlNsRmZZaFFZV2luMDNJYnhObHZKMmtzYThZTFl2RmMKblUwS1gwSzZJS0tQVWg2aWtHY1J0L0h2VlQvVzg2NnhkdWlHdkFqcWgrZzJFK25vVmZiSGNiUlVNN0g4ClI3NkQwcHhwaTZFLzl4anpRb2pJQ1BycktnR0hCVEV2WG00c05UajBwYnpEQjhzV0YzZjR0eXRQQUJFQgpBQUhORjBwaGJtVWdSRzlsSUR4cVlXNWxRR1J2WlM1amIyMCt3c0NLQkJBQkNBQWRCUUppeGZQcEJBc0oKQndnREZRZ0tCQllBQWdFQ0dRRUNHd01DSGdFQUlRa1FRSTRTRGI1MUpmOFdJUVNkUGptc2Frc2JISWd1CmhUWkFqaElOdm5VbC8zNHhCLzR3QTBMNmk0N01KT3RjTGE0ZGp2OVB0UXZOaUJDOHhBdURZS1pXV3VTSAo5WHo0WWYzZW9uOGpTc2N0alN2OGtsNWs5SVZBQmtUM3pXaUNBSmluOC9GUE9nYmg3UGdHNjI1OTRPU0IKWkVkd0JjbDZBaXhsRHVKTjBocDBPeU9hSkZWbmxsUUt5M08zM0RGeFlXblVYQURya1E5TWN5QzlkVVN6CnhMU2M2eGhpRzRlMjNWb1BoNkpBR0xvQSs4VEtHQ1BNTnVDWHlCYVZGTDh4cG1vL2kyQ2UxWXV5WUVYRwpBbWhsdkIxQnlVY0xqSWdiN0JsUkl0QW1vVG5SeFFNQk9nL2ZvR29ldEhFUmpNQjVET0ZSNitGdHVlUnkKT25zQ2RIajRaSTNuSjNsQU5DaXFrbms4RVpWbVVZbHY5QUxiejRZQ05NKzFHNFdNZ1ljejhwZFc1a2ltCnpzQk5CR0xGOCtrQkNBRHFwbFB6OVNGYVJtT2ZEUXhySVpNMGx5SCswQ3E5ek9NdUlrRW82VWIrSkpqQgppWnFYalpFKzIzbjFLUmYrRWdvemFPUmtBdUsxb3plYXZySUx4cTZHaG1yZWtaemtxVnNOQ2hjeGk1bVEKdCt0NytzQ1o5MDRaL3lIR1RMOW1ncWNYUWxOd1l3dzlJbHVtTmNNazVtamF0WmplTEwrcEg3YXRMcUQvCkJPVkR5NmJYa3ZnMlVaSko2NStEd0c3a21EcS9hdGROcElBcGhNdUoxbml2QnYrQ1BkZkVZNDEvcWhGRQpVMFQ1d0FBdFlxMmNzM1JVaHNLWEJicEJDaFJ0YlkzZS9WZGlEdURmWmNWdVVRVVo2Tjh0dnBwNE9IMlIKNzhuemhrVXFJOGNndkc3RU02N2JMTGxsWURZclhLYUMxQ3BZd3lndHRsdmYwRkpubGpjL3pPYUZBQkVCCkFBSEN3SFlFR0FFSUFBa0ZBbUxGOCtrQ0d3d0FJUWtRUUk0U0RiNTFKZjhXSVFTZFBqbXNha3NiSElndQpoVFpBamhJTnZuVWwvL0NlQ0FEb1pTNFBHaHFKZXhMbDhLaE5IVitvUDQ4MllPUWtYU2Z2YkFKbFYxQ20KdUQ0aThZa0lBbDFNZ2poUjZjVzRnQVZvRVhYd3JvUHRzVUVIYXF3VGMrWmpRZ1I2SmN0S09HMjQvc0F2CjdVQllLbDhIZkExUlozbHk1T1p2UHBSOE91SjVSVHozZFBFODc5T0dRdmpPdWpPUGdGVjRiWHY2OXhqVgpUc1d0dFlPYWwzaFVYVlZZY1I3TVVlVldoWGZDcytUVXNNUzRHVjZJSUFxSXVOUmhkWkFib0VVRytZakwKSmdxSmlNdkdEYTRVNlZvbXZ3eS9VckdaQjBOUkFGMzl3MlJtK09XK2pYTXZMclZtYTRMWlJJMmphbzM3Cjd6Y2lmQTlydnFFeklxOHJjeHRLLzMxaVUyWVVIYmJEdC9aN0tUYjVPNWVRUGtNcXR2YkVwWHgyRytrMAo9MXRNbwotLS0tLUVORCBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0tCg==',
};

describe('decrypt', function () {
  it('should decrypt an encryptedMessage', async function () {
    const test = decrypt(data);
    await expect(test).to.eventually.be.fulfilled;
  });
});
